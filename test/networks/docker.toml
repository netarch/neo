[[nodes]]
    name = "fw"
    type = "emulation"
    driver = "docker"
    docker-daemon = "/var/run/docker.sock"
    [nodes.container]
    image = "kyechou/iptables:latest"
    workingDir = "/"
    command = ["/start.sh"]
    config_files = ["/start.sh"]
    [[nodes.container.env]]
    name = "RULES"
    value = """
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -i eth1 -j ACCEPT
-A INPUT -i eth2 -j ACCEPT
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -i eth1 -j ACCEPT
-A FORWARD -i eth2 -j ACCEPT
-A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
COMMIT
"""
    [[nodes.container.sysctls]]
    key = "net.ipv4.conf.all.forwarding"
    value = "1"
    [[nodes.container.sysctls]]
    key = "net.ipv4.conf.all.rp_filter"
    value = "1"     # misconfiguration, should be 0
    [[nodes.interfaces]]
    name = "eth0"
    ipv4 = "10.0.0.2/24"
    [[nodes.interfaces]]
    name = "eth1"
    ipv4 = "192.168.1.1/25"
    [[nodes.interfaces]]
    name = "eth2"
    ipv4 = "192.168.2.1/25"
    [[nodes.static_routes]]
    network = "192.168.0.0/22"
    next_hop = "192.168.1.2"
